require "placeos-driver/spec"

DriverSpecs.mock_driver "Winmate::LedLightBar" do
  should_send(Bytes[0x04, 0x60, 0x10, 140]).responds Bytes[0x04, 0x10, 0xFF, 0xED]
  should_send(Bytes[0x04, 0x60, 0x11, 139]).responds Bytes[0x04, 0x11, 0xFF, 0xEC]
  should_send(Bytes[0x04, 0x60, 0x12, 138]).responds Bytes[0x04, 0x12, 0xFF, 0xEB]
  status[:red].should eq 0xFF
  status[:green].should eq 0xFF
  status[:blue].should eq 0xFF

  resp = exec(:set, "red", 100)
  should_send(Bytes[0x05, 0x61, 0x10, 0x64, 0x26]).responds Bytes[0x03, 0x0C, 0xF1]
  resp.get
  status[:red].should eq 100
end
