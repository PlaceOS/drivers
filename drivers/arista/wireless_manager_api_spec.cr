require "placeos-driver/spec"

DriverSpecs.mock_driver "Arista::WirelessManagerAPI" do
  # new session request runs lazily as required
  expect_http_request do |request, response|
    puts "\n---> #{request.method} #{request.path}\n\n"
    response.status_code = 200
    {
      "Alt-Svc"                 => "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000",
      "Connection"              => "close",
      "Transfer-Encoding"       => "chunked",
      "cache-control"           => "no-store, no-cache, must-revalidate,no-store",
      "content-security-policy" => "frame-ancestors 'self'",
      "content-type"            => "application/json;charset=utf-8",
      "date"                    => "Mon, 20 Oct 2025 06:04:20 GMT",
      "expect-ct"               => "max-age=86400",
      "expires"                 => "Thu, 19 Nov 1981 08:52:00 GMT",
      "permissions-policy"      => "accelerometer=(), ambient-light-sensor=(),autoplay=(),battery=(), camera=(), cross-origin-isolated=(), display-capture=(), document-domain=(), encrypted-media=(),execution-while-not-rendered=(), execution-while-out-of-viewport=(),fullscreen=(), geolocation=(), gyroscope=(),keyboard-map=(), magnetometer=(), microphone=(), midi=(), navigation-override=(), payment=(), picture-in-picture=(),publickey-credentials-get=(), screen-wake-lock=(),usb=(), web-share=(), xr-spatial-tracking=()",
      "pragma"                  => "no-cache",
      "referrer-policy"         => "origin-when-cross-origin",
      "server"                  => "Apache",
      "set-cookie"              => ["ATN_CLOUD_DASHBOARD=mtss3pafo2lutgrqe395rei; path=/; secure; HttpOnly",
                       "GCLB=\"d30359c6448d3\"; Max-Age=86400; Path=/; HttpOnly"],
      "strict-transport-security" => "max-age=63072000; includeSubdomains; preload",
      "vary"                      => "Accept-Encoding,User-Agent",
      "via"                       => "1.1 google",
      "x-content-type-options"    => "nosniff",
      "x-frame-options"           => "SAMEORIGIN",
    }.each do |key, value|
      response.headers[key] = value
    end
    response << %({
      "sessionId": "5637cd7f-6eec-4fa9-9045-275ee5d5a3ce",
      "timeout": 300,
      "clientIdentifier": "PlaceOS",
      "fetchClusterChildrenData": false,
      "userId": -5,
      "langId": 0,
      "customerId": -1,
      "defaultPassword": false,
      "loginId": "KEY-ATN587-1493",
      "firstName": null,
      "lastName": null,
      "email": null,
      "role": "VIEWER",
      "timeZone": "Australia/Sydney",
      "timezonOffSetInMins": 0,
      "passwdSettings": null,
      "allowedLocations": [
        {
          "type": "locallocationid",
          "id": 0
        }
      ],
      "userType": "API",
      "allowAccessMgmt": true,
      "allowSecurityMgmt": true,
      "userLanguage": {
        "langId": 0,
        "langCode": "en",
        "name": "English",
        "systemLanguage": true,
        "supported": true,
        "defaultLanguage": true,
        "countryCode": "US"
      },
      "userDefinedFields": null,
      "wipsAndWiFiCustomer": true
    })
  end

  promise = exec :locations

  status[:authenticated]?.should be_true

  # fetch locations
  location_data = %({
    "type": "folderlocation",
    "id": {
      "type": "locallocationid",
      "id": 0
    },
    "name": "Locations",
    "accessibleToUser": true,
    "defaultLocation": false,
    "timezoneId": "Pacific/Auckland",
    "locationTag": null,
    "venueId": null,
    "sandboxLocation": false,
    "geoInfo": null,
    "children": [
      {
        "type": "folderlocation",
        "id": {
          "type": "locallocationid",
          "id": -1
        },
        "name": "Staging Area",
        "accessibleToUser": true,
        "defaultLocation": true,
        "timezoneId": "Pacific/Auckland",
        "locationTag": null,
        "venueId": null,
        "sandboxLocation": false,
        "geoInfo": null,
        "children": []
      },
      {
        "type": "folderlocation",
        "id": {
          "type": "locallocationid",
          "id": 2
        },
        "name": "New Zealand",
        "accessibleToUser": true,
        "defaultLocation": false,
        "timezoneId": "Pacific/Auckland",
        "locationTag": null,
        "venueId": null,
        "sandboxLocation": false,
        "geoInfo": null,
        "children": [
          {
            "type": "folderlocation",
            "id": {
              "type": "locallocationid",
              "id": 26
            },
            "name": "Bay of Plenty",
            "accessibleToUser": true,
            "defaultLocation": false,
            "timezoneId": "Pacific/Auckland",
            "locationTag": null,
            "venueId": null,
            "sandboxLocation": false,
            "geoInfo": null,
            "children": [
              {
                "type": "folderlocation",
                "id": {
                  "type": "locallocationid",
                  "id": 27
                },
                "name": "Tauranga",
                "accessibleToUser": true,
                "defaultLocation": false,
                "timezoneId": "Pacific/Auckland",
                "locationTag": null,
                "venueId": null,
                "sandboxLocation": false,
                "geoInfo": null
              }
            ]
          }
        ]
      }
    ]
})
  expect_http_request do |request, response|
    puts "\n---> #{request.method} #{request.path}\n\n"
    response.status_code = 200
    response << location_data
  end

  promise.get

  # Flattened locations
  promise = exec :locations_flatten

  expect_http_request do |request, response|
    puts "\n---> #{request.method} #{request.path}\n\n"
    response.status_code = 200
    response << location_data
  end

  promise.get.as_a.size.should eq 5

  # Fetch client positions
  result = exec :client_positions

  expect_http_request do |request, response|
    puts "\n---> #{request.method} #{request.path}\n\n"
    response.status_code = 200
    response << %({
      "status": "RUNNING",
      "requestId": "8030aa74-4ac8-4843-ad79-be51adc59be5",
      "locationTrackingResult": null,
      "previousLink": null,
      "nextLink": null,
      "pollingUrl": "https://wifi.arista.com/new/wifi/api/clients/locationtracking/requests/8030aa74-4ac8-4843-ad79-be51adc59be5",
      "stopLocationTrackingUrl": "https://wifi.arista.com/new/wifi/api/clients/locationtracking/requests/8030aa74-4ac8-4843-ad79-be51adc59be5",
      "deviceCount": 2,
      "totalDeviceCount": 2
    })
  end

  expect_http_request do |request, response|
    puts "\n---> #{request.method} #{request.path}\n\n"
    response.status_code = 200
    response << LOC_PAYLOAD_EXAMPLE
  end
  result.get.size.should eq 2
end

LOC_PAYLOAD_EXAMPLE = %({
  "status": "SUCCESSFUL",
  "requestId": "8030aa74-4ac8-4843-ad79-be51adc59be5",
  "locationTrackingResult": [
    {
      "devicesType": "client",
      "locationId": {
        "type": "locallocationid",
        "id": 306
      },
      "clients": [
        {
          "device": {
            "type": "client",
            "boxId": 496247145,
            "name": "Galaxy-S21-FE-5G",
            "locationId": {
              "type": "locallocationid",
              "id": 5
            },
            "radios": [
              {
                "type": "clientradio",
                "macaddress": "B2:9A:3F:B7:30:6A",
                "active": true,
                "firstDetectedTime": 1705868423000,
                "upSince": 1760574014000,
                "signalStrength": -5000,
                "protocol": "BG",
                "channel": 0,
                "quarantineStatus": "QUARANTINE_STATUS_OFF",
                "captureFlag": 0,
                "captureId": 0,
                "ssid": "",
                "manualPreventionEnabled": false,
                "autopreventionEnabled": true,
                "prevReason": 0,
                "prevPendingReason": 0,
                "opprotocol": "BG",
                "meshFlag": 0,
                "dot11NCapability": 0,
                "dot11ACCapability": 0,
                "dot11AxCapability": 0,
                "associatedAPName": "--",
                "associatedApMac": "--",
                "assocManagedDeviceBoxId": 0,
                "switchChassisId": "",
                "switchPortId": "",
                "uplinkDataRate": 35289,
                "downlinkDataRate": 2376,
                "uplinkUsage": 202,
                "downlinkUsage": 371,
                "retryRate": 5.86,
                "misbehavingReason": 0,
                "opMode": "OP_MODE_BSS",
                "smartDeviceType": null,
                "smartDeviceTypeName": null,
                "smartDeviceTypeId": 0,
                "sdTypeDisplayable": 0,
                "capability": 7,
                "protoCapability": "b | g | ax",
                "sgclientID": 0,
                "connectionStatus": 0,
                "riskStatus": 0,
                "sgClientGroupName": "",
                "clientBridged": false,
                "failureCodes": [
                  8
                ],
                "failureCategory": null,
                "failureCount": 4,
                "successCount": 8,
                "lastConnectionSuccessful": true,
                "lastFailureType": 0,
                "lastFailureTime": 1760583971000,
                "clientConnectionSessionActive": false,
                "lastSuccessTime": 1760584103000,
                "latestAssociatedAPName": "tx6-g-05-ap101",
                "latestAssociatedSSID": "eduroam",
                "latestAssociatedChannel": 5,
                "latestAssociatedProtocol": "BG",
                "latestAssociatedApMac": "30:86:2D:C5:B2:42",
                "is2_4GhzActive": false,
                "is5GhzActive": false,
                "ap6GhzActive": false,
                "wifiCapability2_4Ghz": "WIFI_CAPABILITY_11AX",
                "wifiCapability5Ghz": "WIFI_CAPABILITY_11AX",
                "wifiCapabilityRadio1": "WIFI_CAPABILITY_11AX",
                "wifiCapabilityRadio2": "WIFI_CAPABILITY_11AX",
                "wifiCapabilityRadio3": null,
                "bandRadio1": "BAND_2_4_GHZ",
                "bandRadio2": "BAND_5_GHZ",
                "bandRadio3": "ANY",
                "clientsCountOfAssocRadio": 1,
                "observedBssidsCountByAssocAP": 5507,
                "spatialStream": 0,
                "suMimo": "",
                "muMimo": "",
                "channelWidth": [
                  "--",
                  "--",
                  "--"
                ]
              }
            ],
            "deviceNote": "",
            "ipAddress": "10.28.4.40",
            "activeStatus": null,
            "deviceCapability": null,
            "manuallyTagged": false,
            "group": "AUTHORIZED",
            "userName": "pion@org.nz",
            "vendorName": "Unknown",
            "vlanId": -1,
            "cellId": "",
            "ipv6Addresses": [
              "fe80::b09a:3fff:feb7:306a"
            ],
            "ownSensorMac": "",
            "security": 0,
            "secAuth": 0,
            "allowedSSIDs": [],
            "role": "--",
            "totalCountRequired": false,
            "searchIndex": -100,
            "manuallyClassified": false,
            "misbehaving": "NO",
            "googleAuthorizationStatus": "NOT_AVAILABLE",
            "ipV6Address": "",
            "sticky": false,
            "averageDataRate": 461322,
            "osType": "Android",
            "bestAP": "",
            "bestRssi": -5000,
            "bandCapability": "CAPABILITY_DUAL_BAND",
            "snr": 29,
            "channelContention": 22,
            "wifiInterference": 21,
            "nonWifiInterference": 1,
            "poorCoverage": false,
            "otherBss": 13,
            "latestAssociatedApLocationId": {
              "type": "locallocationid",
              "id": 270
            },
            "poorPerformanceReasons": [],
            "clientsBasedOnExperience": 0,
            "captivePortalAuthStatus": "NOT_APPLICABLE",
            "macAddress": "B2:9A:3F:B7:30:6A",
            "deviceUpperMac": "B2:9A:3F:B7:30:6A",
            "channels": [
              0,
              0,
              0
            ],
            "authSurvMode": 0,
            "mostUsedLink": 0,
            "cipherGroup": "",
            "cipherPair": "",
            "cap802Dot11R": false,
            "cap802Dot11K": false,
            "cap802Dot11V": false,
            "cap802Dot11MC": false,
            "cap802Dot11W": false,
            "powersaveMode": "",
            "securityType": "",
            "banned": false,
            "bestSignalStrength": -53,
            "ownRX": 0,
            "ownTX": 7,
            "radio": {
              "type": "clientradio",
              "macaddress": "B2:9A:3F:B7:30:6A",
              "active": true,
              "firstDetectedTime": 1705868423000,
              "upSince": 1760574014000,
              "signalStrength": -5000,
              "protocol": "BG",
              "channel": 0,
              "quarantineStatus": "QUARANTINE_STATUS_OFF",
              "captureFlag": 0,
              "captureId": 0,
              "ssid": "",
              "manualPreventionEnabled": false,
              "autopreventionEnabled": true,
              "prevReason": 0,
              "prevPendingReason": 0,
              "opprotocol": "BG",
              "meshFlag": 0,
              "dot11NCapability": 0,
              "dot11ACCapability": 0,
              "dot11AxCapability": 0,
              "associatedAPName": "--",
              "associatedApMac": "--",
              "assocManagedDeviceBoxId": 0,
              "switchChassisId": "",
              "switchPortId": "",
              "uplinkDataRate": 35289,
              "downlinkDataRate": 2376,
              "uplinkUsage": 202,
              "downlinkUsage": 371,
              "retryRate": 5.86,
              "misbehavingReason": 0,
              "opMode": "OP_MODE_BSS",
              "smartDeviceType": null,
              "smartDeviceTypeName": null,
              "smartDeviceTypeId": 0,
              "sdTypeDisplayable": 0,
              "capability": 7,
              "protoCapability": "b | g | ax",
              "sgclientID": 0,
              "connectionStatus": 0,
              "riskStatus": 0,
              "sgClientGroupName": "",
              "clientBridged": false,
              "failureCodes": [
                8
              ],
              "failureCategory": null,
              "failureCount": 4,
              "successCount": 8,
              "lastConnectionSuccessful": true,
              "lastFailureType": 0,
              "lastFailureTime": 1760583971000,
              "clientConnectionSessionActive": false,
              "lastSuccessTime": 1760584103000,
              "latestAssociatedAPName": "tx6-g-05-ap101",
              "latestAssociatedSSID": "eduroam",
              "latestAssociatedChannel": 5,
              "latestAssociatedProtocol": "BG",
              "latestAssociatedApMac": "30:86:2D:C5:B2:42",
              "is2_4GhzActive": false,
              "is5GhzActive": false,
              "ap6GhzActive": false,
              "wifiCapability2_4Ghz": "WIFI_CAPABILITY_11AX",
              "wifiCapability5Ghz": "WIFI_CAPABILITY_11AX",
              "wifiCapabilityRadio1": "WIFI_CAPABILITY_11AX",
              "wifiCapabilityRadio2": "WIFI_CAPABILITY_11AX",
              "wifiCapabilityRadio3": null,
              "bandRadio1": "BAND_2_4_GHZ",
              "bandRadio2": "BAND_5_GHZ",
              "bandRadio3": "ANY",
              "clientsCountOfAssocRadio": 1,
              "observedBssidsCountByAssocAP": 5507,
              "spatialStream": 0,
              "suMimo": "",
              "muMimo": "",
              "channelWidth": [
                "--",
                "--",
                "--"
              ]
            },
            "active": true,
            "mloMode": "NOT_AVAILABLE"
          },
          "position": {
            "coordinates": {
              "unit": "FEET",
              "xCordinate": 28.274304863248705,
              "yCordinate": 10.661241431574274,
              "xPosition": 28.274304863248705,
              "yPosition": 10.661241431574274
            },
            "errorCode": null
          },
          "proximity": [
            {
              "observingDevice": {
                "boxId": 513,
                "name": "n-2-01-ap108",
                "locationId": {
                  "type": "locallocationid",
                  "id": 306
                },
                "macaddress": "30:86:2D:C5:69:FF",
                "templateId": 8,
                "platformId": 107,
                "subPlatformId": 1,
                "softwareVersion": "20.0.0-180.3",
                "groupId": null,
                "parentGroupId": 0,
                "groupName": null,
                "deviceBootTime": 1759406990000,
                "vendorName": "Arista",
                "firstDetectedTime": 1672163522930,
                "deviceMode": "AP_SENSOR_COMBO",
                "templateName": "Aware Template",
                "model": "C-230",
                "placed": true,
                "capability": 353,
                "monitoredVlanCount": 0,
                "totalVlanCount": 4,
                "autoDynamicVlanIds": [],
                "meshEnabled": false,
                "failSafeMode": false,
                "deviceNote": null,
                "ipAddress": "10.32.28.143",
                "ipAddressList": null,
                "numEthernetPorts": 2,
                "featureCapabilities": [
                  "THREE_RADIO",
                  "MODEL_AGNOSTIC",
                  "REMOTE_AP_CLI",
                  "RADIO_DISABLE",
                  "MESH_SUPPORT",
                  "LINK_AGGREGATION",
                  "LED_BLINK",
                  "TPM",
                  "SPECTRUM_ANALYSIS",
                  "INTERFERENCE_CLASSIFIER",
                  "WIFI6_AND_NEW_FEATURES",
                  "FEATURE_CUSTOM_CERTIFICATE",
                  "UPLINK_PORT_AUTH",
                  "PCAP_V2",
                  "CCT_V2",
                  "FEATURE_CAPABILITY_ETHERNET_PARITY",
                  "LONGER_LED_BLINK"
                ],
                "active": true,
                "upgradeStatus": 0,
                "lastUpdateTime": 1759406990000,
                "nextScheduledUpdateTime": 0,
                "scheduledUpdateTargetBuild": null,
                "scheduledUpdateDowntimeDuration": 0,
                "troubleshootingStatus": 0,
                "radios": [
                  {
                    "radioId": 2,
                    "active": true,
                    "noiseFloor": -107,
                    "worstClientRssi": -100,
                    "txPower": 19,
                    "rfUtilization": 200,
                    "capability": 51,
                    "apMode": true,
                    "operatingBand": "BAND_5_GHZ",
                    "retryRate": 46,
                    "upstreamUsage": 561,
                    "downstreamUsage": 6965,
                    "wirelessInterfaces": [
                      {
                        "bssid": "30:86:2D:C5:69:D0",
                        "ssid": "waikato-OWE",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 32,
                        "secAuth": 0,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 13,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:69:D1",
                        "ssid": "waikato",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 1,
                        "secAuth": 0,
                        "secGCS": 0,
                        "secPWCS": 0,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "No Encryption",
                        "signalStrength": 0,
                        "ssidProfileId": 14,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:69:D2",
                        "ssid": "eduroam",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 24,
                        "secAuth": 2,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 15,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      }
                    ],
                    "channel": 52,
                    "channelWidth": 1,
                    "channelOffset": 1,
                    "mcsSet11ac": -5570646,
                    "beaconInterval": 100,
                    "supportedRates": -2143646205,
                    "centerFrequencyZero": 54,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 2
                  },
                  {
                    "radioId": 1,
                    "active": true,
                    "noiseFloor": -107,
                    "worstClientRssi": -101,
                    "txPower": 14,
                    "rfUtilization": 2200,
                    "capability": 44,
                    "apMode": true,
                    "operatingBand": "BAND_2_4_GHZ",
                    "retryRate": 17,
                    "upstreamUsage": 18,
                    "downstreamUsage": 4373,
                    "wirelessInterfaces": [
                      {
                        "bssid": "30:86:2D:C5:69:E0",
                        "ssid": "waikato-OWE",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 32,
                        "secAuth": 0,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 13,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:69:E1",
                        "ssid": "waikato",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 1,
                        "secAuth": 0,
                        "secGCS": 0,
                        "secPWCS": 0,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "No Encryption",
                        "signalStrength": 0,
                        "ssidProfileId": 14,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:69:E2",
                        "ssid": "eduroam",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 24,
                        "secAuth": 2,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 15,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:69:E3",
                        "ssid": "yodeck-ssid",
                        "active": true,
                        "numAssocClients": 1,
                        "security": 24,
                        "secAuth": 5,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 42,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      }
                    ],
                    "channel": 9,
                    "channelWidth": 0,
                    "channelOffset": 0,
                    "mcsSet11ac": 0,
                    "beaconInterval": 100,
                    "supportedRates": -2144683266,
                    "centerFrequencyZero": 0,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 1
                  },
                  {
                    "radioId": 3,
                    "active": true,
                    "noiseFloor": 0,
                    "worstClientRssi": 0,
                    "txPower": 0,
                    "rfUtilization": 0,
                    "capability": 31,
                    "apMode": false,
                    "operatingBand": null,
                    "retryRate": 0,
                    "upstreamUsage": 0,
                    "downstreamUsage": 0,
                    "wirelessInterfaces": null,
                    "channel": 0,
                    "channelWidth": 0,
                    "channelOffset": 0,
                    "mcsSet11ac": 0,
                    "beaconInterval": 0,
                    "supportedRates": 0,
                    "centerFrequencyZero": 0,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 3
                  }
                ],
                "spectrumAnalysisState": "STOPPED",
                "interferenceClassifierState": "STOPPED",
                "ledStatus": "BLINK_OFF",
                "ledRequestStatus": "STOP_ACK",
                "quarantineStatus": "QUARANTINE_STATUS_OFF",
                "clientConnectivityState": "OFF",
                "targetAPClientConnectivityStatus": "OFF",
                "networkTag": "10.32.30.0/24",
                "powerSource": "POE_PLUS",
                "bleStatus": "DISABLED",
                "upSince": 1759407238597,
                "manuallyTagged": true,
                "deviceConfigStatus": "ACTIVE",
                "modelAgnosticAware": true,
                "state": "ACTIVE",
                "cipCapable": true,
                "cipModeEnabled": false,
                "certActionError": false,
                "cipTunnelStatus": "DISCONNECTED",
                "coordinates": {
                  "xCordinate": 2.920151696416545,
                  "yCordinate": 10.887461894267314,
                  "xPosition": 2.920151696416545,
                  "yPosition": 10.887461894267314
                },
                "calibrationFactor5Ghz": 0,
                "calibrationFactor2dot4Ghz": 0,
                "calibrationFactor6Ghz": 0,
                "assocCount": 1,
                "meshInfo": null,
                "primaryWiredInterface": {
                  "name": "eth0",
                  "macaddress": "30:86:2d:c5:69:ff",
                  "primaryInterface": true,
                  "sensorLanPortName": "LAN1",
                  "uplinkMode": 2,
                  "portMacAddress": "30:86:2D:C5:69:FF",
                  "requestedPoEPower": 25,
                  "negotiatedPoEPower": 25,
                  "linkStatus": 1,
                  "poEPortName": "eth0",
                  "nativeVLAN": 1111,
                  "commVLAN": 0,
                  "switchName": "n-2-15a-switch-1a.waikato.ac.nz",
                  "switchPortIdSubtype": 5,
                  "switchPortId": "Ethernet43",
                  "switchChassisIdSubtype": 4,
                  "switchChassisId": "ec:8a:48:73:22:25",
                  "switchVendor": "Arista",
                  "linkSpeed": 5000,
                  "sensorLinkSpeed": 5000,
                  "v4dhcpLeaseTime": 43200,
                  "v4dhcpServerIp": "10.250.28.244",
                  "v4nameServer": "10.250.28.248,10.250.28.250,10.248.28.253",
                  "v4defaultGateway": "10.32.28.1",
                  "v4dnsSuffix": "waikato.ac.nz",
                  "v6dhcpLeaseTime": 0,
                  "v6dhcpServerIp": null,
                  "v6nameServer": null,
                  "v6defaultGateway": null,
                  "v6dnsSuffix": null
                },
                "sensorCustomisationStatus": "INHERITED",
                "healthStats": {
                  "minCpuUtilization": 137,
                  "maxCpuUtilization": 571,
                  "avgCpuUtilization": 370,
                  "lastAvgCpuUtilization": 370,
                  "minMemoryUtilization": 4781,
                  "maxMemoryUtilization": 4823,
                  "avgMemoryUtilization": 4796,
                  "lastAvgMemoryUtilization": 4796
                },
                "uplinkPortAuthStatus": {
                  "enabled": false,
                  "authMethod": "NOT_AVAILABLE",
                  "eth0PortName": "--",
                  "eth0PortAuthStatus": "NOT_AVAILABLE",
                  "eth1PortName": "--",
                  "eth1PortAuthStatus": "NOT_AVAILABLE"
                },
                "wiredInterfaces": null,
                "firmwareVersionComplianceStatus": "NA",
                "upgradeProgressStatus": "UNKNOWN",
                "upgradeProgressPercentage": 0,
                "missingVlansDetected": false,
                "apHeight": {
                  "height": -1000002,
                  "unit": "METER"
                },
                "gpsData": {
                  "latitude": 0,
                  "longitude": 0,
                  "height": 0,
                  "refAP11MC": null,
                  "refAP11MCDistance": 0
                },
                "missingVlans": {
                  "missingBridgeVlanIds": [],
                  "missingTunnelVlanIds": []
                },
                "afcStatus": "NOT_SUPPORTED",
                "captureId": 0,
                "mvrpEnabled": false,
                "imagotagInfo": null,
                "configPushStatus": "APPLIED",
                "configPushStatusUpdateTimestamp": 1756265583000,
                "apFipsStatus": "UNKNOWN",
                "anyTunnelsDown": "NA"
              },
              "observedDeviceDistance": {
                "min": {
                  "value": 119.48326242616578,
                  "unit": "FEET"
                },
                "max": {
                  "value": 171.48833779589793,
                  "unit": "FEET"
                }
              }
            },
            {
              "observingDevice": {
                "boxId": 510,
                "name": "n-2-s3-ap109",
                "locationId": {
                  "type": "locallocationid",
                  "id": 306
                },
                "macaddress": "30:86:2D:C5:8E:BF",
                "templateId": 8,
                "platformId": 107,
                "subPlatformId": 1,
                "softwareVersion": "20.0.0-180.3",
                "groupId": null,
                "parentGroupId": 0,
                "groupName": null,
                "deviceBootTime": 1759407487000,
                "vendorName": "Arista",
                "firstDetectedTime": 1672163519225,
                "deviceMode": "AP_SENSOR_COMBO",
                "templateName": "Aware Template",
                "model": "C-230",
                "placed": true,
                "capability": 353,
                "monitoredVlanCount": 0,
                "totalVlanCount": 4,
                "autoDynamicVlanIds": [],
                "meshEnabled": false,
                "failSafeMode": false,
                "deviceNote": null,
                "ipAddress": "10.32.28.153",
                "ipAddressList": null,
                "numEthernetPorts": 2,
                "featureCapabilities": [
                  "THREE_RADIO",
                  "MODEL_AGNOSTIC",
                  "REMOTE_AP_CLI",
                  "RADIO_DISABLE",
                  "MESH_SUPPORT",
                  "LINK_AGGREGATION",
                  "LED_BLINK",
                  "TPM",
                  "SPECTRUM_ANALYSIS",
                  "INTERFERENCE_CLASSIFIER",
                  "WIFI6_AND_NEW_FEATURES",
                  "FEATURE_CUSTOM_CERTIFICATE",
                  "UPLINK_PORT_AUTH",
                  "PCAP_V2",
                  "CCT_V2",
                  "FEATURE_CAPABILITY_ETHERNET_PARITY",
                  "LONGER_LED_BLINK"
                ],
                "active": true,
                "upgradeStatus": 0,
                "lastUpdateTime": 1759407487000,
                "nextScheduledUpdateTime": 0,
                "scheduledUpdateTargetBuild": null,
                "scheduledUpdateDowntimeDuration": 0,
                "troubleshootingStatus": 0,
                "radios": [
                  {
                    "radioId": 3,
                    "active": true,
                    "noiseFloor": 0,
                    "worstClientRssi": 0,
                    "txPower": 0,
                    "rfUtilization": 0,
                    "capability": 31,
                    "apMode": false,
                    "operatingBand": null,
                    "retryRate": 0,
                    "upstreamUsage": 0,
                    "downstreamUsage": 0,
                    "wirelessInterfaces": null,
                    "channel": 0,
                    "channelWidth": 0,
                    "channelOffset": 0,
                    "mcsSet11ac": 0,
                    "beaconInterval": 0,
                    "supportedRates": 0,
                    "centerFrequencyZero": 0,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 3
                  },
                  {
                    "radioId": 2,
                    "active": true,
                    "noiseFloor": -107,
                    "worstClientRssi": -100,
                    "txPower": 17,
                    "rfUtilization": 100,
                    "capability": 51,
                    "apMode": true,
                    "operatingBand": "BAND_5_GHZ",
                    "retryRate": 0,
                    "upstreamUsage": 5,
                    "downstreamUsage": 3087,
                    "wirelessInterfaces": [
                      {
                        "bssid": "30:86:2D:C5:8E:90",
                        "ssid": "waikato-OWE",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 32,
                        "secAuth": 0,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 13,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:8E:91",
                        "ssid": "waikato",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 1,
                        "secAuth": 0,
                        "secGCS": 0,
                        "secPWCS": 0,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "No Encryption",
                        "signalStrength": 0,
                        "ssidProfileId": 14,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:8E:92",
                        "ssid": "eduroam",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 24,
                        "secAuth": 2,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 15,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      }
                    ],
                    "channel": 60,
                    "channelWidth": 1,
                    "channelOffset": 1,
                    "mcsSet11ac": -5570646,
                    "beaconInterval": 100,
                    "supportedRates": -2143646205,
                    "centerFrequencyZero": 62,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 2
                  },
                  {
                    "radioId": 1,
                    "active": true,
                    "noiseFloor": -106,
                    "worstClientRssi": -91,
                    "txPower": 12,
                    "rfUtilization": 1600,
                    "capability": 44,
                    "apMode": true,
                    "operatingBand": "BAND_2_4_GHZ",
                    "retryRate": 5,
                    "upstreamUsage": 183,
                    "downstreamUsage": 859,
                    "wirelessInterfaces": [
                      {
                        "bssid": "30:86:2D:C5:8E:A0",
                        "ssid": "waikato-OWE",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 32,
                        "secAuth": 0,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 13,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:8E:A1",
                        "ssid": "waikato",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 1,
                        "secAuth": 0,
                        "secGCS": 0,
                        "secPWCS": 0,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "No Encryption",
                        "signalStrength": 0,
                        "ssidProfileId": 14,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:8E:A2",
                        "ssid": "eduroam",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 24,
                        "secAuth": 2,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 15,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:8E:A3",
                        "ssid": "yodeck-ssid",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 24,
                        "secAuth": 5,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 42,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      }
                    ],
                    "channel": 13,
                    "channelWidth": 0,
                    "channelOffset": 0,
                    "mcsSet11ac": 0,
                    "beaconInterval": 100,
                    "supportedRates": -2144683266,
                    "centerFrequencyZero": 0,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 1
                  }
                ],
                "spectrumAnalysisState": "STOPPED",
                "interferenceClassifierState": "STOPPED",
                "ledStatus": "BLINK_OFF",
                "ledRequestStatus": "STOP_ACK",
                "quarantineStatus": "QUARANTINE_STATUS_OFF",
                "clientConnectivityState": "OFF",
                "targetAPClientConnectivityStatus": "OFF",
                "networkTag": "10.32.30.0/24",
                "powerSource": "POE_PLUS",
                "bleStatus": "DISABLED",
                "upSince": 1759407779376,
                "manuallyTagged": true,
                "deviceConfigStatus": "ACTIVE",
                "modelAgnosticAware": true,
                "state": "ACTIVE",
                "cipCapable": true,
                "cipModeEnabled": false,
                "certActionError": false,
                "cipTunnelStatus": "DISCONNECTED",
                "coordinates": {
                  "xCordinate": 19.827666432634324,
                  "yCordinate": 15.594444937661763,
                  "xPosition": 19.827666432634324,
                  "yPosition": 15.594444937661763
                },
                "calibrationFactor5Ghz": 0,
                "calibrationFactor2dot4Ghz": 0,
                "calibrationFactor6Ghz": 0,
                "assocCount": 0,
                "meshInfo": null,
                "primaryWiredInterface": {
                  "name": "eth0",
                  "macaddress": "30:86:2d:c5:8e:bf",
                  "primaryInterface": true,
                  "sensorLanPortName": "LAN1",
                  "uplinkMode": 2,
                  "portMacAddress": "30:86:2D:C5:8E:BF",
                  "requestedPoEPower": 25,
                  "negotiatedPoEPower": 25,
                  "linkStatus": 1,
                  "poEPortName": "eth0",
                  "nativeVLAN": 1111,
                  "commVLAN": 0,
                  "switchName": "n-2-15a-switch-1a.waikato.ac.nz",
                  "switchPortIdSubtype": 5,
                  "switchPortId": "Ethernet41",
                  "switchChassisIdSubtype": 4,
                  "switchChassisId": "ec:8a:48:73:22:25",
                  "switchVendor": "Arista",
                  "linkSpeed": 5000,
                  "sensorLinkSpeed": 5000,
                  "v4dhcpLeaseTime": 43200,
                  "v4dhcpServerIp": "10.250.28.244",
                  "v4nameServer": "10.250.28.248,10.250.28.250,10.248.28.253",
                  "v4defaultGateway": "10.32.28.1",
                  "v4dnsSuffix": "waikato.ac.nz",
                  "v6dhcpLeaseTime": 0,
                  "v6dhcpServerIp": null,
                  "v6nameServer": null,
                  "v6defaultGateway": null,
                  "v6dnsSuffix": null
                },
                "sensorCustomisationStatus": "INHERITED",
                "healthStats": {
                  "minCpuUtilization": 125,
                  "maxCpuUtilization": 456,
                  "avgCpuUtilization": 175,
                  "lastAvgCpuUtilization": 175,
                  "minMemoryUtilization": 4726,
                  "maxMemoryUtilization": 4761,
                  "avgMemoryUtilization": 4742,
                  "lastAvgMemoryUtilization": 4742
                },
                "uplinkPortAuthStatus": {
                  "enabled": false,
                  "authMethod": "NOT_AVAILABLE",
                  "eth0PortName": "--",
                  "eth0PortAuthStatus": "NOT_AVAILABLE",
                  "eth1PortName": "--",
                  "eth1PortAuthStatus": "NOT_AVAILABLE"
                },
                "wiredInterfaces": null,
                "firmwareVersionComplianceStatus": "NA",
                "upgradeProgressStatus": "UNKNOWN",
                "upgradeProgressPercentage": 0,
                "missingVlansDetected": false,
                "apHeight": {
                  "height": -1000002,
                  "unit": "METER"
                },
                "gpsData": {
                  "latitude": 0,
                  "longitude": 0,
                  "height": 0,
                  "refAP11MC": null,
                  "refAP11MCDistance": 0
                },
                "missingVlans": {
                  "missingBridgeVlanIds": [],
                  "missingTunnelVlanIds": []
                },
                "afcStatus": "NOT_SUPPORTED",
                "captureId": 0,
                "mvrpEnabled": false,
                "imagotagInfo": null,
                "configPushStatus": "APPLIED",
                "configPushStatusUpdateTimestamp": 1756265583000,
                "apFipsStatus": "UNKNOWN",
                "anyTunnelsDown": "NA"
              },
              "observedDeviceDistance": {
                "min": {
                  "value": 89.4776508408664,
                  "unit": "FEET"
                },
                "max": {
                  "value": 119.48326242616578,
                  "unit": "FEET"
                }
              }
            },
            {
              "observingDevice": {
                "boxId": 473,
                "name": "n-2-17-ap107",
                "locationId": {
                  "type": "locallocationid",
                  "id": 306
                },
                "macaddress": "30:86:2D:C5:99:3F",
                "templateId": 8,
                "platformId": 107,
                "subPlatformId": 1,
                "softwareVersion": "20.0.0-180.3",
                "groupId": null,
                "parentGroupId": 0,
                "groupName": null,
                "deviceBootTime": 1759407483000,
                "vendorName": "Arista",
                "firstDetectedTime": 1672163481661,
                "deviceMode": "AP_SENSOR_COMBO",
                "templateName": "Aware Template",
                "model": "C-230",
                "placed": true,
                "capability": 353,
                "monitoredVlanCount": 0,
                "totalVlanCount": 4,
                "autoDynamicVlanIds": [],
                "meshEnabled": false,
                "failSafeMode": false,
                "deviceNote": null,
                "ipAddress": "10.32.28.141",
                "ipAddressList": null,
                "numEthernetPorts": 2,
                "featureCapabilities": [
                  "THREE_RADIO",
                  "MODEL_AGNOSTIC",
                  "REMOTE_AP_CLI",
                  "RADIO_DISABLE",
                  "MESH_SUPPORT",
                  "LINK_AGGREGATION",
                  "LED_BLINK",
                  "TPM",
                  "SPECTRUM_ANALYSIS",
                  "INTERFERENCE_CLASSIFIER",
                  "WIFI6_AND_NEW_FEATURES",
                  "FEATURE_CUSTOM_CERTIFICATE",
                  "UPLINK_PORT_AUTH",
                  "PCAP_V2",
                  "CCT_V2",
                  "FEATURE_CAPABILITY_ETHERNET_PARITY",
                  "LONGER_LED_BLINK"
                ],
                "active": true,
                "upgradeStatus": 0,
                "lastUpdateTime": 1759407483000,
                "nextScheduledUpdateTime": 0,
                "scheduledUpdateTargetBuild": null,
                "scheduledUpdateDowntimeDuration": 0,
                "troubleshootingStatus": 0,
                "radios": [
                  {
                    "radioId": 2,
                    "active": true,
                    "noiseFloor": -107,
                    "worstClientRssi": -98,
                    "txPower": 15,
                    "rfUtilization": 800,
                    "capability": 51,
                    "apMode": true,
                    "operatingBand": "BAND_5_GHZ",
                    "retryRate": 412,
                    "upstreamUsage": 23649,
                    "downstreamUsage": 65042,
                    "wirelessInterfaces": [
                      {
                        "bssid": "30:86:2D:C5:99:10",
                        "ssid": "waikato-OWE",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 32,
                        "secAuth": 0,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 13,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:99:11",
                        "ssid": "waikato",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 1,
                        "secAuth": 0,
                        "secGCS": 0,
                        "secPWCS": 0,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "No Encryption",
                        "signalStrength": 0,
                        "ssidProfileId": 14,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:99:12",
                        "ssid": "eduroam",
                        "active": true,
                        "numAssocClients": 4,
                        "security": 24,
                        "secAuth": 2,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 15,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      }
                    ],
                    "channel": 124,
                    "channelWidth": 1,
                    "channelOffset": 1,
                    "mcsSet11ac": -5570646,
                    "beaconInterval": 100,
                    "supportedRates": -2143646205,
                    "centerFrequencyZero": 126,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 2
                  },
                  {
                    "radioId": 1,
                    "active": true,
                    "noiseFloor": -107,
                    "worstClientRssi": -73,
                    "txPower": 5,
                    "rfUtilization": 1100,
                    "capability": 44,
                    "apMode": true,
                    "operatingBand": "BAND_2_4_GHZ",
                    "retryRate": 1,
                    "upstreamUsage": 16,
                    "downstreamUsage": 313,
                    "wirelessInterfaces": [
                      {
                        "bssid": "30:86:2D:C5:99:20",
                        "ssid": "waikato-OWE",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 32,
                        "secAuth": 0,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 13,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:99:21",
                        "ssid": "waikato",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 1,
                        "secAuth": 0,
                        "secGCS": 0,
                        "secPWCS": 0,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "No Encryption",
                        "signalStrength": 0,
                        "ssidProfileId": 14,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:99:22",
                        "ssid": "eduroam",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 24,
                        "secAuth": 2,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 15,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:99:23",
                        "ssid": "yodeck-ssid",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 24,
                        "secAuth": 5,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 42,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      }
                    ],
                    "channel": 5,
                    "channelWidth": 0,
                    "channelOffset": 0,
                    "mcsSet11ac": 0,
                    "beaconInterval": 100,
                    "supportedRates": -2144683266,
                    "centerFrequencyZero": 0,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 1
                  },
                  {
                    "radioId": 3,
                    "active": true,
                    "noiseFloor": 0,
                    "worstClientRssi": 0,
                    "txPower": 0,
                    "rfUtilization": 0,
                    "capability": 31,
                    "apMode": false,
                    "operatingBand": null,
                    "retryRate": 0,
                    "upstreamUsage": 0,
                    "downstreamUsage": 0,
                    "wirelessInterfaces": null,
                    "channel": 0,
                    "channelWidth": 0,
                    "channelOffset": 0,
                    "mcsSet11ac": 0,
                    "beaconInterval": 0,
                    "supportedRates": 0,
                    "centerFrequencyZero": 0,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 3
                  }
                ],
                "spectrumAnalysisState": "STOPPED",
                "interferenceClassifierState": "STOPPED",
                "ledStatus": "BLINK_OFF",
                "ledRequestStatus": "STOP_ACK",
                "quarantineStatus": "QUARANTINE_STATUS_OFF",
                "clientConnectivityState": "OFF",
                "targetAPClientConnectivityStatus": "OFF",
                "networkTag": "10.32.30.0/24",
                "powerSource": "POE_PLUS",
                "bleStatus": "DISABLED",
                "upSince": 1759407762644,
                "manuallyTagged": true,
                "deviceConfigStatus": "ACTIVE",
                "modelAgnosticAware": true,
                "state": "ACTIVE",
                "cipCapable": true,
                "cipModeEnabled": false,
                "certActionError": false,
                "cipTunnelStatus": "DISCONNECTED",
                "coordinates": {
                  "xCordinate": 28.06857432756683,
                  "yCordinate": 10.692749303199237,
                  "xPosition": 28.06857432756683,
                  "yPosition": 10.692749303199237
                },
                "calibrationFactor5Ghz": 0,
                "calibrationFactor2dot4Ghz": 0,
                "calibrationFactor6Ghz": 0,
                "assocCount": 4,
                "meshInfo": null,
                "primaryWiredInterface": {
                  "name": "eth0",
                  "macaddress": "30:86:2d:c5:99:3f",
                  "primaryInterface": true,
                  "sensorLanPortName": "LAN1",
                  "uplinkMode": 2,
                  "portMacAddress": "30:86:2D:C5:99:3F",
                  "requestedPoEPower": 25,
                  "negotiatedPoEPower": 25,
                  "linkStatus": 1,
                  "poEPortName": "eth0",
                  "nativeVLAN": 1111,
                  "commVLAN": 0,
                  "switchName": "n-2-15a-switch-1a.waikato.ac.nz",
                  "switchPortIdSubtype": 5,
                  "switchPortId": "Ethernet44",
                  "switchChassisIdSubtype": 4,
                  "switchChassisId": "ec:8a:48:73:22:25",
                  "switchVendor": "Arista",
                  "linkSpeed": 5000,
                  "sensorLinkSpeed": 5000,
                  "v4dhcpLeaseTime": 43200,
                  "v4dhcpServerIp": "10.250.28.244",
                  "v4nameServer": "10.250.28.248,10.250.28.250,10.248.28.253",
                  "v4defaultGateway": "10.32.28.1",
                  "v4dnsSuffix": "waikato.ac.nz",
                  "v6dhcpLeaseTime": 0,
                  "v6dhcpServerIp": null,
                  "v6nameServer": null,
                  "v6defaultGateway": "fe80::21c:73ff:fe00:99",
                  "v6dnsSuffix": null
                },
                "sensorCustomisationStatus": "INHERITED",
                "healthStats": {
                  "minCpuUtilization": 141,
                  "maxCpuUtilization": 588,
                  "avgCpuUtilization": 372,
                  "lastAvgCpuUtilization": 372,
                  "minMemoryUtilization": 5058,
                  "maxMemoryUtilization": 5089,
                  "avgMemoryUtilization": 5076,
                  "lastAvgMemoryUtilization": 5076
                },
                "uplinkPortAuthStatus": {
                  "enabled": false,
                  "authMethod": "NOT_AVAILABLE",
                  "eth0PortName": "--",
                  "eth0PortAuthStatus": "NOT_AVAILABLE",
                  "eth1PortName": "--",
                  "eth1PortAuthStatus": "NOT_AVAILABLE"
                },
                "wiredInterfaces": null,
                "firmwareVersionComplianceStatus": "NA",
                "upgradeProgressStatus": "UNKNOWN",
                "upgradeProgressPercentage": 0,
                "missingVlansDetected": false,
                "apHeight": {
                  "height": -1000002,
                  "unit": "METER"
                },
                "gpsData": {
                  "latitude": 0,
                  "longitude": 0,
                  "height": 0,
                  "refAP11MC": null,
                  "refAP11MCDistance": 0
                },
                "missingVlans": {
                  "missingBridgeVlanIds": [],
                  "missingTunnelVlanIds": []
                },
                "afcStatus": "NOT_SUPPORTED",
                "captureId": 0,
                "mvrpEnabled": false,
                "imagotagInfo": null,
                "configPushStatus": "APPLIED",
                "configPushStatusUpdateTimestamp": 1756265583000,
                "apFipsStatus": "UNKNOWN",
                "anyTunnelsDown": "NA"
              },
              "observedDeviceDistance": {
                "min": {
                  "value": 24.41823089414956,
                  "unit": "FEET"
                },
                "max": {
                  "value": 32.438403166617185,
                  "unit": "FEET"
                }
              }
            },
            {
              "observingDevice": {
                "boxId": 498,
                "name": "n-2-17-ap106",
                "locationId": {
                  "type": "locallocationid",
                  "id": 306
                },
                "macaddress": "30:86:2D:C5:69:0F",
                "templateId": 8,
                "platformId": 107,
                "subPlatformId": 1,
                "softwareVersion": "20.0.0-180.3",
                "groupId": null,
                "parentGroupId": 0,
                "groupName": null,
                "deviceBootTime": 1759408033000,
                "vendorName": "Arista",
                "firstDetectedTime": 1672163507391,
                "deviceMode": "AP_SENSOR_COMBO",
                "templateName": "Aware Template",
                "model": "C-230",
                "placed": true,
                "capability": 353,
                "monitoredVlanCount": 0,
                "totalVlanCount": 4,
                "autoDynamicVlanIds": [],
                "meshEnabled": false,
                "failSafeMode": false,
                "deviceNote": null,
                "ipAddress": "10.32.28.142",
                "ipAddressList": null,
                "numEthernetPorts": 2,
                "featureCapabilities": [
                  "THREE_RADIO",
                  "MODEL_AGNOSTIC",
                  "REMOTE_AP_CLI",
                  "RADIO_DISABLE",
                  "MESH_SUPPORT",
                  "LINK_AGGREGATION",
                  "LED_BLINK",
                  "TPM",
                  "SPECTRUM_ANALYSIS",
                  "INTERFERENCE_CLASSIFIER",
                  "WIFI6_AND_NEW_FEATURES",
                  "FEATURE_CUSTOM_CERTIFICATE",
                  "UPLINK_PORT_AUTH",
                  "PCAP_V2",
                  "CCT_V2",
                  "FEATURE_CAPABILITY_ETHERNET_PARITY",
                  "LONGER_LED_BLINK"
                ],
                "active": true,
                "upgradeStatus": 0,
                "lastUpdateTime": 1759408034000,
                "nextScheduledUpdateTime": 0,
                "scheduledUpdateTargetBuild": null,
                "scheduledUpdateDowntimeDuration": 0,
                "troubleshootingStatus": 0,
                "radios": [
                  {
                    "radioId": 2,
                    "active": true,
                    "noiseFloor": -108,
                    "worstClientRssi": -66,
                    "txPower": 12,
                    "rfUtilization": 400,
                    "capability": 51,
                    "apMode": true,
                    "operatingBand": "BAND_5_GHZ",
                    "retryRate": 490,
                    "upstreamUsage": 18604,
                    "downstreamUsage": 277194,
                    "wirelessInterfaces": [
                      {
                        "bssid": "30:86:2D:C5:68:E0",
                        "ssid": "waikato-OWE",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 32,
                        "secAuth": 0,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 13,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:68:E1",
                        "ssid": "waikato",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 1,
                        "secAuth": 0,
                        "secGCS": 0,
                        "secPWCS": 0,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "No Encryption",
                        "signalStrength": 0,
                        "ssidProfileId": 14,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:68:E2",
                        "ssid": "eduroam",
                        "active": true,
                        "numAssocClients": 3,
                        "security": 24,
                        "secAuth": 2,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 15,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      }
                    ],
                    "channel": 157,
                    "channelWidth": 1,
                    "channelOffset": 1,
                    "mcsSet11ac": -5570646,
                    "beaconInterval": 100,
                    "supportedRates": -2143646205,
                    "centerFrequencyZero": 159,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 2
                  },
                  {
                    "radioId": 3,
                    "active": true,
                    "noiseFloor": 0,
                    "worstClientRssi": 0,
                    "txPower": 0,
                    "rfUtilization": 0,
                    "capability": 31,
                    "apMode": false,
                    "operatingBand": null,
                    "retryRate": 0,
                    "upstreamUsage": 0,
                    "downstreamUsage": 0,
                    "wirelessInterfaces": null,
                    "channel": 0,
                    "channelWidth": 0,
                    "channelOffset": 0,
                    "mcsSet11ac": 0,
                    "beaconInterval": 0,
                    "supportedRates": 0,
                    "centerFrequencyZero": 0,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 3
                  },
                  {
                    "radioId": 1,
                    "active": true,
                    "noiseFloor": -107,
                    "worstClientRssi": 0,
                    "txPower": 7,
                    "rfUtilization": 800,
                    "capability": 44,
                    "apMode": true,
                    "operatingBand": "BAND_2_4_GHZ",
                    "retryRate": 0,
                    "upstreamUsage": 0,
                    "downstreamUsage": 0,
                    "wirelessInterfaces": [
                      {
                        "bssid": "30:86:2D:C5:68:F0",
                        "ssid": "waikato-OWE",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 32,
                        "secAuth": 0,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 13,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:68:F1",
                        "ssid": "waikato",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 1,
                        "secAuth": 0,
                        "secGCS": 0,
                        "secPWCS": 0,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "No Encryption",
                        "signalStrength": 0,
                        "ssidProfileId": 14,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:68:F2",
                        "ssid": "eduroam",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 24,
                        "secAuth": 2,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 15,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C5:68:F3",
                        "ssid": "yodeck-ssid",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 24,
                        "secAuth": 5,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 42,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      }
                    ],
                    "channel": 5,
                    "channelWidth": 0,
                    "channelOffset": 0,
                    "mcsSet11ac": 0,
                    "beaconInterval": 100,
                    "supportedRates": -2144683266,
                    "centerFrequencyZero": 0,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 1
                  }
                ],
                "spectrumAnalysisState": "STOPPED",
                "interferenceClassifierState": "STOPPED",
                "ledStatus": "BLINK_OFF",
                "ledRequestStatus": "STOP_ACK",
                "quarantineStatus": "QUARANTINE_STATUS_OFF",
                "clientConnectivityState": "OFF",
                "targetAPClientConnectivityStatus": "OFF",
                "networkTag": "10.32.30.0/24",
                "powerSource": "POE_PLUS",
                "bleStatus": "DISABLED",
                "upSince": 1759408295128,
                "manuallyTagged": true,
                "deviceConfigStatus": "ACTIVE",
                "modelAgnosticAware": true,
                "state": "ACTIVE",
                "cipCapable": true,
                "cipModeEnabled": false,
                "certActionError": false,
                "cipTunnelStatus": "DISCONNECTED",
                "coordinates": {
                  "xCordinate": 18.919792468111275,
                  "yCordinate": 10.466836592388281,
                  "xPosition": 18.919792468111275,
                  "yPosition": 10.466836592388281
                },
                "calibrationFactor5Ghz": 0,
                "calibrationFactor2dot4Ghz": 0,
                "calibrationFactor6Ghz": 0,
                "assocCount": 3,
                "meshInfo": null,
                "primaryWiredInterface": {
                  "name": "eth0",
                  "macaddress": "30:86:2d:c5:69:0f",
                  "primaryInterface": true,
                  "sensorLanPortName": "LAN1",
                  "uplinkMode": 2,
                  "portMacAddress": "30:86:2D:C5:69:0F",
                  "requestedPoEPower": 25,
                  "negotiatedPoEPower": 25,
                  "linkStatus": 1,
                  "poEPortName": "eth0",
                  "nativeVLAN": 1111,
                  "commVLAN": 0,
                  "switchName": "n-2-15a-switch-1a.waikato.ac.nz",
                  "switchPortIdSubtype": 5,
                  "switchPortId": "Ethernet46",
                  "switchChassisIdSubtype": 4,
                  "switchChassisId": "ec:8a:48:73:22:25",
                  "switchVendor": "Arista",
                  "linkSpeed": 5000,
                  "sensorLinkSpeed": 5000,
                  "v4dhcpLeaseTime": 43200,
                  "v4dhcpServerIp": "10.250.28.244",
                  "v4nameServer": "10.250.28.248,10.250.28.250,10.248.28.253",
                  "v4defaultGateway": "10.32.28.1",
                  "v4dnsSuffix": "waikato.ac.nz",
                  "v6dhcpLeaseTime": 0,
                  "v6dhcpServerIp": null,
                  "v6nameServer": null,
                  "v6defaultGateway": "fe80::21c:73ff:fe00:99",
                  "v6dnsSuffix": null
                },
                "sensorCustomisationStatus": "INHERITED",
                "healthStats": {
                  "minCpuUtilization": 140,
                  "maxCpuUtilization": 542,
                  "avgCpuUtilization": 240,
                  "lastAvgCpuUtilization": 240,
                  "minMemoryUtilization": 4873,
                  "maxMemoryUtilization": 4896,
                  "avgMemoryUtilization": 4879,
                  "lastAvgMemoryUtilization": 4879
                },
                "uplinkPortAuthStatus": {
                  "enabled": false,
                  "authMethod": "NOT_AVAILABLE",
                  "eth0PortName": "--",
                  "eth0PortAuthStatus": "NOT_AVAILABLE",
                  "eth1PortName": "--",
                  "eth1PortAuthStatus": "NOT_AVAILABLE"
                },
                "wiredInterfaces": null,
                "firmwareVersionComplianceStatus": "NA",
                "upgradeProgressStatus": "UNKNOWN",
                "upgradeProgressPercentage": 0,
                "missingVlansDetected": false,
                "apHeight": {
                  "height": -1000002,
                  "unit": "METER"
                },
                "gpsData": {
                  "latitude": 0,
                  "longitude": 0,
                  "height": 0,
                  "refAP11MC": null,
                  "refAP11MCDistance": 0
                },
                "missingVlans": {
                  "missingBridgeVlanIds": [],
                  "missingTunnelVlanIds": []
                },
                "afcStatus": "NOT_SUPPORTED",
                "captureId": 0,
                "mvrpEnabled": false,
                "imagotagInfo": null,
                "configPushStatus": "APPLIED",
                "configPushStatusUpdateTimestamp": 1756265583000,
                "apFipsStatus": "UNKNOWN",
                "anyTunnelsDown": "NA"
              },
              "observedDeviceDistance": {
                "min": {
                  "value": 84.47632804519856,
                  "unit": "FEET"
                },
                "max": {
                  "value": 109.4817336362555,
                  "unit": "FEET"
                }
              }
            }
          ]
        },
        {
          "device": {
            "type": "client",
            "boxId": 528082727,
            "name": "WistronN_6E:BE:03",
            "locationId": {
              "type": "locallocationid",
              "id": 5
            },
            "radios": [
              {
                "type": "clientradio",
                "macaddress": "70:61:BE:6E:BE:03",
                "active": true,
                "firstDetectedTime": 1755883472000,
                "upSince": 1755883472000,
                "signalStrength": -5000,
                "protocol": "BG",
                "channel": 0,
                "quarantineStatus": "QUARANTINE_STATUS_OFF",
                "captureFlag": 0,
                "captureId": 0,
                "ssid": "",
                "manualPreventionEnabled": false,
                "autopreventionEnabled": true,
                "prevReason": 0,
                "prevPendingReason": 0,
                "opprotocol": "BG",
                "meshFlag": 0,
                "dot11NCapability": 0,
                "dot11ACCapability": 0,
                "dot11AxCapability": 0,
                "associatedAPName": "--",
                "associatedApMac": "--",
                "assocManagedDeviceBoxId": 0,
                "switchChassisId": "",
                "switchPortId": "",
                "uplinkDataRate": 0,
                "downlinkDataRate": 0,
                "uplinkUsage": 0,
                "downlinkUsage": 0,
                "retryRate": -1,
                "misbehavingReason": 0,
                "opMode": "OP_MODE_UNKNOWN",
                "smartDeviceType": null,
                "smartDeviceTypeName": null,
                "smartDeviceTypeId": 0,
                "sdTypeDisplayable": 0,
                "capability": 0,
                "protoCapability": "b | g",
                "sgclientID": 0,
                "connectionStatus": 0,
                "riskStatus": 0,
                "sgClientGroupName": "",
                "clientBridged": false,
                "failureCodes": [],
                "failureCategory": null,
                "failureCount": 0,
                "successCount": 0,
                "lastConnectionSuccessful": null,
                "lastFailureType": 0,
                "lastFailureTime": 0,
                "clientConnectionSessionActive": false,
                "lastSuccessTime": 0,
                "latestAssociatedAPName": "",
                "latestAssociatedSSID": "",
                "latestAssociatedChannel": 0,
                "latestAssociatedProtocol": "BG",
                "latestAssociatedApMac": "",
                "is2_4GhzActive": false,
                "is5GhzActive": false,
                "ap6GhzActive": false,
                "wifiCapability2_4Ghz": null,
                "wifiCapability5Ghz": null,
                "wifiCapabilityRadio1": null,
                "wifiCapabilityRadio2": null,
                "wifiCapabilityRadio3": null,
                "bandRadio1": "ANY",
                "bandRadio2": "ANY",
                "bandRadio3": "ANY",
                "clientsCountOfAssocRadio": 0,
                "observedBssidsCountByAssocAP": 0,
                "spatialStream": 0,
                "suMimo": "",
                "muMimo": "",
                "channelWidth": [
                  "--",
                  "--",
                  "--"
                ]
              }
            ],
            "deviceNote": "",
            "ipAddress": "",
            "activeStatus": null,
            "deviceCapability": null,
            "manuallyTagged": false,
            "group": "UNCATEGORIZED",
            "userName": "--",
            "vendorName": "WistronN",
            "vlanId": -1,
            "cellId": "",
            "ipv6Addresses": [],
            "ownSensorMac": "",
            "security": 0,
            "secAuth": 0,
            "allowedSSIDs": [],
            "role": "",
            "totalCountRequired": false,
            "searchIndex": -100,
            "manuallyClassified": false,
            "misbehaving": "NA",
            "googleAuthorizationStatus": "NOT_AVAILABLE",
            "ipV6Address": "",
            "sticky": false,
            "averageDataRate": 0,
            "osType": "",
            "bestAP": "",
            "bestRssi": -5000,
            "bandCapability": "CAPABILITY_DUAL_BAND",
            "snr": 0,
            "channelContention": 0,
            "wifiInterference": 0,
            "nonWifiInterference": 0,
            "poorCoverage": false,
            "otherBss": 0,
            "latestAssociatedApLocationId": {
              "type": "locallocationid",
              "id": 5
            },
            "poorPerformanceReasons": [],
            "clientsBasedOnExperience": 0,
            "captivePortalAuthStatus": "NOT_APPLICABLE",
            "macAddress": "70:61:BE:6E:BE:03",
            "deviceUpperMac": "70:61:BE:6E:BE:03",
            "channels": [
              0,
              0,
              0
            ],
            "authSurvMode": 0,
            "mostUsedLink": -1,
            "cipherGroup": "",
            "cipherPair": "",
            "cap802Dot11R": false,
            "cap802Dot11K": false,
            "cap802Dot11V": false,
            "cap802Dot11MC": false,
            "cap802Dot11W": false,
            "powersaveMode": "",
            "securityType": "",
            "banned": false,
            "bestSignalStrength": -79,
            "ownRX": 0,
            "ownTX": 0,
            "radio": {
              "type": "clientradio",
              "macaddress": "70:61:BE:6E:BE:03",
              "active": true,
              "firstDetectedTime": 1755883472000,
              "upSince": 1755883472000,
              "signalStrength": -5000,
              "protocol": "BG",
              "channel": 0,
              "quarantineStatus": "QUARANTINE_STATUS_OFF",
              "captureFlag": 0,
              "captureId": 0,
              "ssid": "",
              "manualPreventionEnabled": false,
              "autopreventionEnabled": true,
              "prevReason": 0,
              "prevPendingReason": 0,
              "opprotocol": "BG",
              "meshFlag": 0,
              "dot11NCapability": 0,
              "dot11ACCapability": 0,
              "dot11AxCapability": 0,
              "associatedAPName": "--",
              "associatedApMac": "--",
              "assocManagedDeviceBoxId": 0,
              "switchChassisId": "",
              "switchPortId": "",
              "uplinkDataRate": 0,
              "downlinkDataRate": 0,
              "uplinkUsage": 0,
              "downlinkUsage": 0,
              "retryRate": -1,
              "misbehavingReason": 0,
              "opMode": "OP_MODE_UNKNOWN",
              "smartDeviceType": null,
              "smartDeviceTypeName": null,
              "smartDeviceTypeId": 0,
              "sdTypeDisplayable": 0,
              "capability": 0,
              "protoCapability": "b | g",
              "sgclientID": 0,
              "connectionStatus": 0,
              "riskStatus": 0,
              "sgClientGroupName": "",
              "clientBridged": false,
              "failureCodes": [],
              "failureCategory": null,
              "failureCount": 0,
              "successCount": 0,
              "lastConnectionSuccessful": null,
              "lastFailureType": 0,
              "lastFailureTime": 0,
              "clientConnectionSessionActive": false,
              "lastSuccessTime": 0,
              "latestAssociatedAPName": "",
              "latestAssociatedSSID": "",
              "latestAssociatedChannel": 0,
              "latestAssociatedProtocol": "BG",
              "latestAssociatedApMac": "",
              "is2_4GhzActive": false,
              "is5GhzActive": false,
              "ap6GhzActive": false,
              "wifiCapability2_4Ghz": null,
              "wifiCapability5Ghz": null,
              "wifiCapabilityRadio1": null,
              "wifiCapabilityRadio2": null,
              "wifiCapabilityRadio3": null,
              "bandRadio1": "ANY",
              "bandRadio2": "ANY",
              "bandRadio3": "ANY",
              "clientsCountOfAssocRadio": 0,
              "observedBssidsCountByAssocAP": 0,
              "spatialStream": 0,
              "suMimo": "",
              "muMimo": "",
              "channelWidth": [
                "--",
                "--",
                "--"
              ]
            },
            "active": true,
            "mloMode": "NOT_AVAILABLE"
          },
          "position": {
            "coordinates": null,
            "errorCode": "NOT_ENOUGH_PLACED_OBSERVING_SENSORS_TO_FIND_POSITION"
          },
          "proximity": [
            {
              "observingDevice": {
                "boxId": 104,
                "name": "f-3-06-ap119",
                "locationId": {
                  "type": "locallocationid",
                  "id": 48
                },
                "macaddress": "30:86:2D:C1:8C:2F",
                "templateId": 8,
                "platformId": 107,
                "subPlatformId": 1,
                "softwareVersion": "20.0.0-180.3",
                "groupId": null,
                "parentGroupId": 0,
                "groupName": null,
                "deviceBootTime": 1759407584000,
                "vendorName": "Arista",
                "firstDetectedTime": 1615333960863,
                "deviceMode": "AP_SENSOR_COMBO",
                "templateName": "Aware Template",
                "model": "C-230",
                "placed": true,
                "capability": 353,
                "monitoredVlanCount": 0,
                "totalVlanCount": 4,
                "autoDynamicVlanIds": [],
                "meshEnabled": false,
                "failSafeMode": false,
                "deviceNote": null,
                "ipAddress": "10.14.28.126",
                "ipAddressList": null,
                "numEthernetPorts": 2,
                "featureCapabilities": [
                  "THREE_RADIO",
                  "MODEL_AGNOSTIC",
                  "REMOTE_AP_CLI",
                  "RADIO_DISABLE",
                  "MESH_SUPPORT",
                  "LINK_AGGREGATION",
                  "LED_BLINK",
                  "TPM",
                  "SPECTRUM_ANALYSIS",
                  "INTERFERENCE_CLASSIFIER",
                  "WIFI6_AND_NEW_FEATURES",
                  "FEATURE_CUSTOM_CERTIFICATE",
                  "UPLINK_PORT_AUTH",
                  "PCAP_V2",
                  "CCT_V2",
                  "FEATURE_CAPABILITY_ETHERNET_PARITY",
                  "LONGER_LED_BLINK"
                ],
                "active": true,
                "upgradeStatus": 0,
                "lastUpdateTime": 1759407585000,
                "nextScheduledUpdateTime": 0,
                "scheduledUpdateTargetBuild": null,
                "scheduledUpdateDowntimeDuration": 0,
                "troubleshootingStatus": 0,
                "radios": [
                  {
                    "radioId": 1,
                    "active": true,
                    "noiseFloor": -108,
                    "worstClientRssi": 0,
                    "txPower": 9,
                    "rfUtilization": 1400,
                    "capability": 44,
                    "apMode": true,
                    "operatingBand": "BAND_2_4_GHZ",
                    "retryRate": 1,
                    "upstreamUsage": 0,
                    "downstreamUsage": 0,
                    "wirelessInterfaces": [
                      {
                        "bssid": "30:86:2D:C1:8C:10",
                        "ssid": "waikato-OWE",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 32,
                        "secAuth": 0,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 13,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C1:8C:11",
                        "ssid": "waikato",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 1,
                        "secAuth": 0,
                        "secGCS": 0,
                        "secPWCS": 0,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "No Encryption",
                        "signalStrength": 0,
                        "ssidProfileId": 14,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C1:8C:12",
                        "ssid": "eduroam",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 24,
                        "secAuth": 2,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 15,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C1:8C:13",
                        "ssid": "yodeck-ssid",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 24,
                        "secAuth": 5,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 42,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_2_4_GHZ"
                      }
                    ],
                    "channel": 13,
                    "channelWidth": 0,
                    "channelOffset": 0,
                    "mcsSet11ac": 0,
                    "beaconInterval": 100,
                    "supportedRates": -2144683266,
                    "centerFrequencyZero": 0,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 1
                  },
                  {
                    "radioId": 2,
                    "active": true,
                    "noiseFloor": -107,
                    "worstClientRssi": -73,
                    "txPower": 18,
                    "rfUtilization": 400,
                    "capability": 51,
                    "apMode": true,
                    "operatingBand": "BAND_5_GHZ",
                    "retryRate": 329,
                    "upstreamUsage": 281280,
                    "downstreamUsage": 290671,
                    "wirelessInterfaces": [
                      {
                        "bssid": "30:86:2D:C1:8C:00",
                        "ssid": "waikato-OWE",
                        "active": true,
                        "numAssocClients": 2,
                        "security": 32,
                        "secAuth": 0,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 13,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C1:8C:01",
                        "ssid": "waikato",
                        "active": true,
                        "numAssocClients": 0,
                        "security": 1,
                        "secAuth": 0,
                        "secGCS": 0,
                        "secPWCS": 0,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "No Encryption",
                        "signalStrength": 0,
                        "ssidProfileId": 14,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      },
                      {
                        "bssid": "30:86:2D:C1:8C:02",
                        "ssid": "eduroam",
                        "active": true,
                        "numAssocClients": 1,
                        "security": 24,
                        "secAuth": 2,
                        "secGCS": 8,
                        "secPWCS": 8,
                        "securitySettingFailureReason": null,
                        "protoCapability": "11ax",
                        "encryption": "CCMP",
                        "signalStrength": 0,
                        "ssidProfileId": 15,
                        "ssidUpperMac": "",
                        "puncturedPattern": "00000000",
                        "authSurvMode": 0,
                        "configRadioId": "CONFIG_RADIO_ID_BAND_5_GHZ"
                      }
                    ],
                    "channel": 157,
                    "channelWidth": 1,
                    "channelOffset": 1,
                    "mcsSet11ac": -5570646,
                    "beaconInterval": 100,
                    "supportedRates": -2143646205,
                    "centerFrequencyZero": 159,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 2
                  },
                  {
                    "radioId": 3,
                    "active": true,
                    "noiseFloor": 0,
                    "worstClientRssi": 0,
                    "txPower": 0,
                    "rfUtilization": 0,
                    "capability": 31,
                    "apMode": false,
                    "operatingBand": null,
                    "retryRate": 0,
                    "upstreamUsage": 0,
                    "downstreamUsage": 0,
                    "wirelessInterfaces": null,
                    "channel": 0,
                    "channelWidth": 0,
                    "channelOffset": 0,
                    "mcsSet11ac": 0,
                    "beaconInterval": 0,
                    "supportedRates": 0,
                    "centerFrequencyZero": 0,
                    "centerFrequencyOne": 0,
                    "radioConfigId": 3
                  }
                ],
                "spectrumAnalysisState": "STOPPED",
                "interferenceClassifierState": "STOPPED",
                "ledStatus": "BLINK_OFF",
                "ledRequestStatus": "STOP_ACK",
                "quarantineStatus": "QUARANTINE_STATUS_OFF",
                "clientConnectivityState": "OFF",
                "targetAPClientConnectivityStatus": "OFF",
                "networkTag": "10.14.30.0/24",
                "powerSource": "POE_PLUS",
                "bleStatus": "DISABLED",
                "upSince": 1759407876563,
                "manuallyTagged": true,
                "deviceConfigStatus": "ACTIVE",
                "modelAgnosticAware": true,
                "state": "ACTIVE",
                "cipCapable": true,
                "cipModeEnabled": false,
                "certActionError": false,
                "cipTunnelStatus": "DISCONNECTED",
                "coordinates": {
                  "xCordinate": 5.674220302339234,
                  "yCordinate": 2.624858757062147,
                  "xPosition": 5.674220302339234,
                  "yPosition": 2.624858757062147
                },
                "calibrationFactor5Ghz": 0,
                "calibrationFactor2dot4Ghz": 0,
                "calibrationFactor6Ghz": 0,
                "assocCount": 3,
                "meshInfo": null,
                "primaryWiredInterface": {
                  "name": "eth0",
                  "macaddress": "30:86:2d:c1:8c:2f",
                  "primaryInterface": true,
                  "sensorLanPortName": "LAN1",
                  "uplinkMode": 2,
                  "portMacAddress": "30:86:2D:C1:8C:2F",
                  "requestedPoEPower": 25,
                  "negotiatedPoEPower": 25,
                  "linkStatus": 1,
                  "poEPortName": "eth0",
                  "nativeVLAN": 1111,
                  "commVLAN": 0,
                  "switchName": "f-1-11a-leaf-1a.waikato.ac.nz",
                  "switchPortIdSubtype": 5,
                  "switchPortId": "Ethernet89",
                  "switchChassisIdSubtype": 4,
                  "switchChassisId": "d4:af:f7:7b:45:e9",
                  "switchVendor": "Arista",
                  "linkSpeed": 5000,
                  "sensorLinkSpeed": 5000,
                  "v4dhcpLeaseTime": 43200,
                  "v4dhcpServerIp": "10.250.28.244",
                  "v4nameServer": "10.250.28.248,10.250.28.250,10.248.28.253",
                  "v4defaultGateway": "10.14.28.1",
                  "v4dnsSuffix": "waikato.ac.nz",
                  "v6dhcpLeaseTime": 0,
                  "v6dhcpServerIp": null,
                  "v6nameServer": null,
                  "v6defaultGateway": null,
                  "v6dnsSuffix": null
                },
                "sensorCustomisationStatus": "INHERITED",
                "healthStats": {
                  "minCpuUtilization": 136,
                  "maxCpuUtilization": 595,
                  "avgCpuUtilization": 344,
                  "lastAvgCpuUtilization": 344,
                  "minMemoryUtilization": 5163,
                  "maxMemoryUtilization": 5193,
                  "avgMemoryUtilization": 5178,
                  "lastAvgMemoryUtilization": 5178
                },
                "uplinkPortAuthStatus": {
                  "enabled": false,
                  "authMethod": "NOT_AVAILABLE",
                  "eth0PortName": "--",
                  "eth0PortAuthStatus": "NOT_AVAILABLE",
                  "eth1PortName": "--",
                  "eth1PortAuthStatus": "NOT_AVAILABLE"
                },
                "wiredInterfaces": null,
                "firmwareVersionComplianceStatus": "NA",
                "upgradeProgressStatus": "UNKNOWN",
                "upgradeProgressPercentage": 0,
                "missingVlansDetected": false,
                "apHeight": {
                  "height": -1000002,
                  "unit": "METER"
                },
                "gpsData": {
                  "latitude": 0,
                  "longitude": 0,
                  "height": 0,
                  "refAP11MC": null,
                  "refAP11MCDistance": 0
                },
                "missingVlans": {
                  "missingBridgeVlanIds": [],
                  "missingTunnelVlanIds": []
                },
                "afcStatus": "NOT_SUPPORTED",
                "captureId": 0,
                "mvrpEnabled": false,
                "imagotagInfo": null,
                "configPushStatus": "APPLIED",
                "configPushStatusUpdateTimestamp": 1756265583000,
                "apFipsStatus": "UNKNOWN",
                "anyTunnelsDown": "NA"
              },
              "observedDeviceDistance": {
                "min": {
                  "value": 21.784672457487172,
                  "unit": "METER"
                },
                "max": {
                  "value": 25.748384788176523,
                  "unit": "METER"
                }
              }
            }
          ]
        }
      ]
    }
  ]
})
